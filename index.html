<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MyShelf ğŸ“š - Sua Biblioteca Digital</title>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link rel="stylesheet" href="index.css">
</head>
<body>
    <header class="header">
        <div class="header-content">
            <a href="#" class="logo" onclick="navigateTo('home')">MyShelf ğŸ“š</a>
            <nav class="nav">
                <a href="#" class="nav-link" data-page="home" onclick="navigateTo('home')">InÃ­cio</a>
                <a href="#" class="nav-link" data-page="library" onclick="navigateTo('library')">Biblioteca</a>
                <a href="#" class="nav-link" data-page="explore" onclick="navigateTo('explore')">Explorar</a>
                <a href="#" class="nav-link" data-page="affinity" onclick="navigateTo('affinity')">Afinidades</a>
                <a href="#" class="nav-link" data-page="stats" onclick="navigateTo('stats')">EstatÃ­sticas</a>
                <a href="#" class="nav-link" data-page="profile" onclick="navigateTo('profile')">Perfil</a>
                <button class="dark-mode-toggle" onclick="toggleDarkMode()">ğŸŒ™</button>
                <button class="btn btn-primary" onclick="fazerLogout()">Sair</button>
                <!-- <button class="btn btn-primary" onclick="navigateTo('library')">Entrar</button> -->
            </nav> 
            <button class="menu-toggle" onclick="toggleSidebar()">â˜°</button>
        </div>
    </header>

    <div id="homePage" class="page active">
        <div class="container">
            <div class="hero">
                <h1>Bem-vindo ao MyShelf ğŸ“š</h1>
                <p>Sua biblioteca digital pessoal para organizar desejos e curtidas culturais</p>
                <button class="btn btn-primary" onclick="navigateTo('library')">ComeÃ§ar Agora</button>
            </div>

            <div class="section-header">
                <h2 class="section-title">Obras Populares</h2>
            </div>

            <div class="cards-grid" id="popularWorks">
                <div class="loading">
                    <div class="spinner"></div>
                    Carregando obras populares...
                </div>
            </div>
        </div>
    </div>

    <div id="libraryPage" class="page">
        <div class="container">
            <div class="library-top">
                <div>
                    <h1 class="library-title">Minha Biblioteca</h1>
                    <p class="library-subtitle"><span id="libraryCount">0</span> obras na sua coleÃ§Ã£o</p>
                </div>
                <button class="btn btn-primary add-top-btn" onclick="openAddModal()">â• Adicionar Obra</button>
            </div>

            <div class="filters-card">
                <div class="filters-header">ğŸ” <strong>Filtros</strong></div>
                <div class="search-filter">
                    <input type="text" class="input" placeholder="ğŸ” Buscar por nome..." id="searchInput" oninput="filterWorks()">
                    <select class="select" id="typeFilter" onchange="filterWorks()">
                        <option value="">Todos os tipos</option>
                        <option value="livro">ğŸ“š Livro</option>
                        <option value="filme">ğŸ¬ Filme</option>
                        <option value="serie">ğŸ“º SÃ©rie</option>
                    </select>
                    <select class="select" id="genreFilter" onchange="filterWorks()">
                        <option value="">Todos os gÃªneros</option>
                        <option value="ficcao">FicÃ§Ã£o</option>
                        <option value="fantasia">Fantasia</option>
                        <option value="romance">Romance</option>
                        <option value="terror">Terror</option>
                        <option value="acao">AÃ§Ã£o</option>
                        <option value="comedia">ComÃ©dia</option>
                        <option value="drama">Drama</option>
                        <option value="scifi">Sci-Fi</option>
                    </select>
                </div>
            </div>

            <div class="library-tabs" role="tablist">
                <button class="library-tab active" data-filter="all" onclick="filterLibrary('all')">Todas <span class="tab-count" id="tabTotal">0</span></button>
                <button class="library-tab" data-filter="liked" onclick="filterLibrary('liked')">â¤ï¸ Curtidas <span class="tab-count" id="tabLiked">0</span></button>
                <button class="library-tab" data-filter="wishlist" onclick="filterLibrary('wishlist')">ğŸ’¬ Desejos <span class="tab-count" id="tabWishlist">0</span></button>
                <button class="library-tab" data-filter="affinity" onclick="navigateTo('affinity')">ğŸ¤ Afinidades</button>
            </div>

            <div class="cards-grid" id="libraryCards">
                <div class="empty-state">
                    <div class="empty-state-icon">ğŸ“š</div>
                    <h3>Sua biblioteca estÃ¡ vazia.</h3>
                    <p>Adicione sua primeira obra clicando em <strong>â• Adicionar Obra</strong></p>
                </div>
            </div>
        </div>

        <button class="fab" onclick="openAddModal()">+</button>
    </div>

    <div id="explorePage" class="page">
        <div class="container">
            <div class="section-header">
                <h2 class="section-title">ğŸŒ Explorar Obras</h2>
            </div>

            <div class="explore-tabs">
                <button class="explore-tab active" data-type="filme" onclick="setExploreType('filme')">ğŸ¬ Filmes</button>
                <button class="explore-tab" data-type="serie" onclick="setExploreType('serie')">ğŸ“º SÃ©ries</button>
                <button class="explore-tab" data-type="livro" onclick="setExploreType('livro')">ğŸ“š Livros</button>
            </div>

            <div class="search-filter explore-search">
                <input type="text" class="input explore-input" placeholder="ğŸ” Buscar filmes..." id="exploreSearch" onkeydown="if(event.key==='Enter') searchExternalAPI()">
                <button class="explore-search-btn" onclick="searchExternalAPI()">ğŸ”</button>
            </div>

            <div class="cards-grid" id="exploreCards">
                <div class="empty-state">
                    <div class="empty-state-icon">ğŸ”</div>
                    <h3>Descubra novas obras</h3>
                    <p>Use a busca acima para encontrar filmes, sÃ©ries ou livros</p>
                </div>
            </div>
        </div>
    </div>

    <div id="affinityPage" class="page">
        <div class="container">
            <div class="affinity-header">
                <h1 class="library-title">Afinidades ğŸ¤</h1>
                <p class="library-subtitle">Encontre pessoas com gostos similares aos seus</p>
            </div>

            <div class="affinity-stats-grid">
                <div class="affinity-stat-card">
                    <div class="stat-icon">ğŸ‘¥</div>
                    <div class="stat-number" id="affinityUsers">0</div>
                    <div class="stat-label">UsuÃ¡rios sugeridos</div>
                </div>
                <div class="affinity-stat-card">
                    <div class="stat-icon">ğŸ’–</div>
                    <div class="stat-number" id="affinityLikes">0</div>
                    <div class="stat-label">Suas curtidas</div>
                </div>
                <div class="affinity-stat-card">
                    <div class="stat-icon">ğŸ“š</div>
                    <div class="stat-number" id="affinityTotalWorks">0</div>
                    <div class="stat-label">Total de obras</div>
                </div>
            </div>

            <div class="affinity-list-grid" id="affinityList"></div>
        </div>
    </div>

    <div id="statsPage" class="page">
        <div class="container">
            <div class="stats-header">
                <div>
                    <h1 class="library-title">EstatÃ­sticas ğŸ“Š</h1>
                    <p class="library-subtitle">Visualize seus hÃ¡bitos e preferÃªncias culturais</p>
                </div>
            </div>

            <div class="stats-top-cards">
                <div class="stat-card">
                    <div class="stat-icon">ğŸ“š</div>
                    <div class="stat-number" id="totalBooks">0</div>
                    <div class="stat-label">Livros</div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon">ğŸ¬</div>
                    <div class="stat-number" id="totalMovies">0</div>
                    <div class="stat-label">Filmes</div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon">ğŸ“º</div>
                    <div class="stat-number" id="totalSeries">0</div>
                    <div class="stat-label">SÃ©ries</div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon">â¤ï¸</div>
                    <div class="stat-number" id="totalLiked">0</div>
                    <div class="stat-label">Curtidas</div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon">ğŸ“‘</div>
                    <div class="stat-number" id="totalWishlist">0</div>
                    <div class="stat-label">Desejos</div>
                </div>
            </div>

            <div class="chart-grid">
                <div class="chart-card">
                    <h3>DistribuiÃ§Ã£o por GÃªneros</h3>
                    <canvas id="genreChart"></canvas>
                </div>
                <div class="top5-card">
                    <h3>Top 5 GÃªneros</h3>
                    <div id="topGenres"></div>
                </div>
            </div>

            <div class="summary-box">
                <h3>Resumo Geral</h3>
                <div class="summary-grid">
                    <div>
                        <h4>Suas PreferÃªncias</h4>
                        <p>Total de obras: <strong id="sumTotal">0</strong></p>
                        <p>Taxa de curtidas: <strong id="sumLikedRate">0%</strong></p>
                        <p>Obras desejadas: <strong id="sumWishlist">0</strong></p>
                    </div>

                    <div>
                        <h4>DistribuiÃ§Ã£o por Tipo</h4>
                        <p><span class="type-icon">ğŸ“š</span> Livros: <strong id="distBooks">0</strong> â€” <span id="distBooksPct">0%</span></p>
                        <p><span class="type-icon">ğŸ¬</span> Filmes: <strong id="distMovies">0</strong> â€” <span id="distMoviesPct">0%</span></p>
                        <p><span class="type-icon">ğŸ“º</span> SÃ©ries: <strong id="distSeries">0</strong> â€” <span id="distSeriesPct">0%</span></p>
                    </div>
                </div>
            </div>

        </div>
    </div>

    <div id="profilePage" class="page">
        <div class="container">
            <div class="profile-header">
                <div class="profile-top-actions" style="display:flex; justify-content:flex-end; gap:0.75rem;">
                    <button id="btnProfileLogout" class="btn btn-outline" onclick="fazerLogout()">Sair</button>
                    <button id="btnProfileSave" class="btn btn-primary" style="display:none;" onclick="saveProfileEdit()">ğŸ’¾ Salvar</button>
                    <button id="btnProfileCancel" class="btn btn-secondary" style="display:none;" onclick="cancelProfileEdit()">Cancelar</button>
                    <button id="btnProfileEdit" class="btn btn-outline" onclick="startEditProfile()">Editar</button>
                </div>

                <div id="profileView">
                    <div class="profile-avatar" id="profileAvatar">
                        <img id="profileAvatarImg" class="avatar-img" alt="Avatar" style="display:none;" />
                        <span id="profileAvatarLetter" class="avatar-letter">U</span>
                    </div>
                    <h2 id="profileName">UsuÃ¡rio MyShelf</h2>
                    <p id="profileEmail" style="color:var(--text-light); margin-top:0.25rem;">a@a</p>
                    <p id="profileBio">Amante de boas histÃ³rias e grandes aventuras ğŸ“–</p>
                </div>

                <form id="profileEditForm" class="profile-edit-form" style="display:none;" onsubmit="saveProfileEdit(event)">
                    <div style="text-align:center;">
                        <label for="profileAvatarInput" class="avatar-upload">
                            <div class="profile-avatar" id="profileAvatarPreview">
                                <img id="profileAvatarPreviewImg" class="avatar-img" alt="Avatar Preview" style="display:none;" />
                                <span id="profileAvatarPreviewLetter" class="avatar-letter">U</span>
                            </div>
                            <div class="avatar-upload-text">Alterar foto</div>
                        </label>
                        <input type="file" id="profileAvatarInput" accept="image/*" onchange="handleAvatarFileChange(event)" style="display:none;">
                        <div style="margin-top:8px;"><button type="button" id="profileRemovePhotoBtn" class="btn btn-outline" style="display:none; padding:0.4rem 0.8rem;" onclick="removeProfileAvatar()">Remover foto</button></div>
                    </div>

                    <label>Nome</label>
                    <input class="input" id="profileNameInput" type="text" required>

                    <label>E-mail</label>
                    <input class="input" id="profileEmailInput" type="email" required>
                    <div id="profileEmailError" class="input-error" style="display:none;"></div>

                    <label>Bio</label>
                    <textarea class="input" id="profileBioInput" rows="4"></textarea>
                </form>
            </div>

            <div class="profile-actions" style="text-align:center; margin-top:1rem;">
                <button class="btn btn-secondary" onclick="clearAllData()">ğŸ—‘ï¸ Limpar todos os dados</button>
            </div>
        </div>
    </div> 



    <div class="modal" id="addModal">
        <div class="modal-content">
            <h2 class="modal-header">â• Adicionar Nova Obra</h2>
            
            <form id="addWorkForm" onsubmit="saveWork(event)">
                <div class="form-group">
                    <label class="form-label">Nome da Obra *</label>
                    <input type="text" class="input" id="workName" required>
                </div>

                <div class="form-group">
                    <label class="form-label">Tipo *</label>
                    <select class="select input" id="workType" required>
                        <option value="">Selecione...</option>
                        <option value="livro">ğŸ“š Livro</option>
                        <option value="filme">ğŸ¬ Filme</option>
                        <option value="serie">ğŸ“º SÃ©rie</option>
                    </select>
                </div>

                <div class="form-group">
                    <label class="form-label">GÃªnero *</label>
                    <select class="select input" id="workGenre" required>
                        <option value="">Selecione...</option>
                        <option value="ficcao">FicÃ§Ã£o</option>
                        <option value="fantasia">Fantasia</option>
                        <option value="romance">Romance</option>
                        <option value="terror">Terror</option>
                        <option value="acao">AÃ§Ã£o</option>
                        <option value="comedia">ComÃ©dia</option>
                        <option value="drama">Drama</option>
                        <option value="scifi">Sci-Fi</option>
                    </select>
                </div>

                <div class="form-group">
                    <label class="form-label">DescriÃ§Ã£o</label>
                    <textarea class="textarea" id="workDescription" rows="4"></textarea>
                </div>

                <div class="form-group">
                    <label class="form-label">Imagem da Capa</label>
                    <div class="file-upload" onclick="document.getElementById('workImage').click()">
                        <p>ğŸ“¸ Clique para adicionar uma imagem</p>
                        <input type="file" id="workImage" accept="image/*" style="display: none;" onchange="previewImage(event)">
                        <img id="imagePreview" style="max-width: 200px; margin-top: 1rem; display: none;">
                    </div>
                </div>

                <div class="modal-actions">
                    <button type="submit" class="btn btn-primary" style="flex: 1;">Salvar</button>
                    <button type="button" class="btn btn-secondary" style="flex: 1;" onclick="closeAddModal()">Cancelar</button>
                </div>
            </form>
        </div>
    </div>

    <footer class="footer">
        <p>MyShelf ğŸ“š - Sua biblioteca digital pessoal</p>
        <p style="color: var(--text-light); margin-top: 0.5rem;">Feito com â¤ï¸ para amantes de cultura</p>
    </footer>

    <script src="index.js" defer></script>
</body>